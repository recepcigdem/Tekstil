@using Microsoft.AspNetCore.Mvc.Localization


@inject IViewLocalizer Localizer
@inject UI.Utils.LocalizationService SharedLocalizer

@{
    Layout = null;
}


<!DOCTYPE html>
<html class="no-js css-menubar" lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description" content="bootstrap admin template">
    <meta name="author" content="">

    <title>@Localizer["Title"]</title>

    <link rel="apple-touch-icon" href="~/assets/images/apple-touch-icon.png" />
    <link rel="shortcut icon" href="~/assets/images/favicon.ico" />

    <!-- Stylesheets -->
    <link rel="stylesheet" href="~/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/css/bootstrap-extend.min.css">
    <link rel="stylesheet" href="~/css/site.min.css">

    <!-- Plugins -->
    <link rel="stylesheet" href="~/plugin/animsition/animsition.min.css">
    <link rel="stylesheet" href="~/plugin/asscrollable/asScrollable.min.css">
    <link rel="stylesheet" href="~/plugin/switchery/switchery.min.css">
    <link rel="stylesheet" href="~/plugin/intro-js/introjs.min.css">
    <link rel="stylesheet" href="~/plugin/slidepanel/slidePanel.min.css">
    <link rel="stylesheet" href="~/plugin/flag-icon-css/flag-icon.min.css">
    <link href="~/plugin/sweetalert/sweetalert2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/login.css">


    <!-- Fonts -->
    <link rel="stylesheet" href="~/assets/fonts/web-icons/web-icons.min.css">
    <link rel="stylesheet" href="~/assets/fonts/brand-icons/brand-icons.css">
    <link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Roboto:300,400,500,300italic'>

    <!--[if lt IE 9]>
    <script src="../../../global/vendor/html5shiv/html5shiv.min.js"></script>
    <![endif]-->
    <!--[if lt IE 10]>
    <script src="../../../global/vendor/media-match/media.match.min.js"></script>
    <script src="../../../global/vendor/respond/respond.min.js"></script>
    <![endif]-->
    <!-- Scripts -->

    <script src="~/plugin/jquery/jquery-3.4.1.min.js"></script>
    <script src="~/plugin/sweetalert/sweetalert2.min.js"></script>
    <script src="~/js/utils.js"></script>
    <script src="~/plugin/breakpoints/breakpoints.min.js"></script>
    <script>
        Breakpoints();
    </script>
</head>
<body class="page-login layout-full page-dark">
    <!--[if lt IE 8]>
        <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    <!-- Page -->
    <div class="page vertical-align text-center">
        <div class="page-content vertical-align-middle  ">
            <div class="brand">
                <img class="brand-img" src="/assets/images/logo.png" alt="...">
                <h2 class="brand-text">@Localizer["Tekstil"].Value</h2>
            </div>
            <p style="font-size:22px">@Localizer["ResetPassword"].Value.ToString()</p>
            <p>@Localizer["InputInfo"]</p>
            @*@using (Html.BeginForm("CompleteResetPassword", "Login", FormMethod.Post))
                {
                    <input type="hidden" name="Id" value="@Context.Request.Query["Id"].ToString().Replace(" ","+")" />
                    @if (ViewBag.Error != null)
                    {
                        <script type="text/javascript">
                            ShowError("Hata", "@Html.Raw(ViewBag.Error)");
                        </script>
                    }
                    <div class="form-group">
                        <div class="input-group">
                            <input type="password" class="form-control" id="inputPassword" name="password" placeholder="@Localizer["Password"]">
                            <div class="input-group-addon">
                                <i class="wb-eye-close"></i>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-group">
                            <input type="password" class="form-control" id="inputConfirmPassword" name="confirmPassword" placeholder="@Localizer["ConfirmPassword"]">
                            <div class="input-group-addon">
                                <i class="wb-eye-close"></i>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <button type="submit"  class="btn btn-primary btn-block">@Localizer["ButtonReset"]</button>
                    </div>
                }*@


            <form method="post" role="form" name="form" id="form">
                <div class="form-group">
                    <div class="input-group">
                        <input type="password" class="form-control" id="inputPassword" name="password" placeholder="@Localizer["Password"]">
                        <div class="input-group-addon">
                            <i class="wb-eye-close"></i>
                        </div>
                    </div>
                </div>
                <input type="hidden" name="Id" id="Id" value="@Context.Request.Query["Id"].ToString().Replace(" ","+")" />
                <div class="form-group">
                    <input type="password" class="form-control" id="inputConfirmPassword" name="confirmPassword" placeholder="@Localizer["ConfirmPassword"]">
                </div>
                <div class="form-group">
                    <button type="button" onclick="ResetPassword()" class="btn btn-primary btn-block">@Localizer["ButtonReset"]</button>
                </div>
            </form>

            <footer class="page-copyright page-copyright-inverse">
                <p>@Localizer["ApplicationBy"]</p>
                <p>2021 @Localizer["AllRightsReserved"]</p>
                <div class="social">
                    <a class="btn btn-icon btn-pure" href="javascript:void(0)">
                        <i class="icon bd-twitter" aria-hidden="true"></i>
                    </a>
                    <a class="btn btn-icon btn-pure" href="javascript:void(0)">
                        <i class="icon bd-facebook" aria-hidden="true"></i>
                    </a>
                    <a class="btn btn-icon btn-pure" href="javascript:void(0)">
                        <i class="icon bd-dribbble" aria-hidden="true"></i>
                    </a>
                </div>
            </footer>
        </div>
    </div>
    <!-- End Page -->
    <!-- Core  -->
    <script src="~/plugin/babel-external-helpers/babel-external-helpers.js"></script>
    @*<script src="~/plugin/jquery/jquery.js"></script>*@
    <script src="~/plugin/JQuery/jquery-3.4.1.min.js"></script>
    <script src="~/plugin/popper-js/umd/popper.min.js"></script>
    <script src="~/plugin/bootstrap/bootstrap.min.js"></script>
    <script src="~/plugin/animsition/animsition.min.js"></script>
    <script src="~/plugin/mousewheel/jquery.mousewheel.js"></script>
    <script src="~/plugin/asscrollbar/jquery-asScrollbar.min.js"></script>
    <script src="~/plugin/asscrollable/jquery-asScrollable.min.js"></script>
    <script src="~/plugin/ashoverscroll/jquery-asHoverScroll.min.js"></script>
    <!-- Plugins -->
    <script src="~/plugin/switchery/switchery.min.js"></script>
    <script src="~/plugin/intro-js/intro.min.js"></script>
    <script src="~/plugin/screenfull/screenfull.js"></script>
    <script src="~/plugin/slidepanel/jquery-slidePanel.min.js"></script>
    <script src="~/plugin/jquery-placeholder/jquery.placeholder.js"></script>
    <!-- Scripts -->
    <script src="~/js/Component.js"></script>
    <script src="~/js/Plugin.js"></script>
    <script src="~/js/Base.js"></script>
    <script src="~/js/Config.js"></script>
    <script src="~/js/Menubar.js"></script>
    <script src="~/js/GridMenu.js"></script>
    <script src="~/js/Sidebar.js"></script>
    <script src="~/js/PageAside.js"></script>
    <script src="~/js/menu.js"></script>
    <script src="~/js/colors.js"></script>
    <script src="~/js/tour.js"></script>
    <script>Config.set('assets', '../assets');</script>
    <!-- Page -->
    <script src="~/js/Site.js"></script>
    <script src="~/js/Plugin/asscrollable.js"></script>
    <script src="~/js/Plugin/slidepanel.js"></script>
    <script src="~/js/Plugin/switchery.js"></script>
    <script src="~/js/Plugin/jquery-placeholder.js"></script>
    <script>
        (function (document, window, $) {
            'use strict';
            var Site = window.Site;
            $(document).ready(function () {
                Site.run();
            });
        })(document, window, jQuery);</script>
    <script type="text/javascript">
        $(function () {
            $(".input-group-addon i").click(function () {
                $(this).toggleClass("wb-eye-close wb-eye");

                var input = $($(this).closest('.input-group').find('input'));
                var confirmPassword = $('#inputConfirmPassword');

                if (input.attr("type") == "text") {
                    input.attr("type", "password");
                    confirmPassword.attr("type", "password");
                } else {
                    input.attr("type", "text");
                    confirmPassword.attr("type", "text");
                }
            });
        });


        function ResetPassword() {
            var password = $('#inputPassword').val();
            var confirmPassword = $('#inputConfirmPassword').val();
            var Id = $('#Id').val();

            var url = "@Url.Action("CompleteResetPassword", "Login")" + "?Id=" + Id + "?password=" + password + "?confirmPassword=" + confirmPassword;
                $.post(url,
                    $("form").serialize(), function (data) {
                        if (data.result == false)
                            ShowError('@SharedLocalizer.GetLocalizedHtmlString("ErrorTitle")', data.message);
                        else
                            ShowSuccess('@Localizer["SuccessMessageTitle"]','@Localizer["SuccessMessage"]',
                                function () {
                                    window.location = "/"+ GetCulture() +"/Login";
                                }
                            );
                    });
        };


       function ShowSuccess(title, message) {
        Swal.fire({
            position: 'top-end',
            title: title,
            text: message,
            icon: 'success',
            showCloseButton: true,
            showConfirmButton: true,
            padding: '4em'
        }).then(function () {
            @*window.location.href = "/" + GetCulture() + "@Url.Action("Index", "Role")";*@
             window.location = "/"+ GetCulture() +"/Login";
        });
        }

         function ShowError(title, message) {

        Swal.fire({
            position: 'top-end',
            title: title,
            text: message,
            icon: 'error',
            showCloseButton: true,
            showConfirmButton: true,
            padding: '4em'
        });
    }
    </script>
</body>
</html>
